identities:
- node:
    name: araali_cni
    zone: .*
    app: k8s-nodes
    binary_name: .*/bin/araali-cni
    parent_process: kubelet
    process: araali-cni
  pushdown:
    binary_name: ^.*/bin/araali-cni$
- node:
    name: node_1
    rename: guarantor
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /opt/araali/bin/guarantor
    parent_process: araalictl
    process: guarantor
  pushdown: {}
- node:
    name: node_10
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /usr/lib/jvm/java-[0-9]+-openjdk-amd64/bin/java
    parent_process: guarantor-helpe
    process: org.owasp.dependencycheck.App
  pushdown: {}
- node:
    name: node_11
    dns_pattern: nvd.nist.gov
    dst_port: 443
  pushdown:
    dns_pattern: .*:nvd.nist.gov:.*
- node:
    name: node_12
    dns_pattern: jeremylong.github.io
    dst_port: 443
  pushdown:
    dns_pattern: .*:jeremylong.github.io:.*
- node:
    name: node_13
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /usr/bin/wget
    parent_process: guarantor-helpe
    process: wget
  pushdown: {}
- node:
    name: node_14
    dns_pattern: github-releases.githubusercontent.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:github-releases.githubusercontent.com:.*
- node:
    name: node_15
    dns_pattern: github.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:github.com:.*
- node:
    name: node_16
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /usr/lib/apt/methods/http
    parent_process: apt
    process: http
  pushdown: {}
- node:
    name: node_17
    dns_pattern: archive.ubuntu.com
    dst_port: 80
  pushdown:
    dns_pattern: .*:archive.ubuntu.com:.*
- node:
    name: node_18
    dns_pattern: .*s3.*.amazonaws.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:.*s3.*.amazonaws.com:.*
- node:
    name: node_19
    dns_pattern: quay.io
    dst_port: 443
  pushdown:
    dns_pattern: .*:quay.io:.*
- node:
    name: node_20
    dns_pattern: gcr.io
    dst_port: 443
  pushdown:
    dns_pattern: .*:gcr.io:.*
- node:
    name: node_21
    dns_pattern: repo1.maven.org
    dst_port: 443
  pushdown:
    dns_pattern: .*:repo1.maven.org:.*
- node:
    name: node_22
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /opt/araali/bin/grype
    parent_process: sh
    process: grype
  pushdown: {}
- node:
    name: node_23
    dns_pattern: packages.cloud.google.com
    dst_port: 80
  pushdown:
    dns_pattern: .*:packages.cloud.google.com:.*
- node:
    name: node_24
    dns_pattern: objects.githubusercontent.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:objects.githubusercontent.com:.*
- node:
    name: node_25
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /opt/araali/bin/syft
    parent_process: sh
    process: syft
  pushdown: {}
- node:
    name: node_26
    dns_pattern: .*ecr.*.amazonaws.com
    dst_port: 443
  pushdown: {}
- node:
    name: node_27
    dns_pattern: public.ecr.aws
    dst_port: 443
  pushdown: {}
- node:
    name: node_3
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /usr/lib/jvm/java-[0-9]+-openjdk-amd64/bin/java
    parent_process: sh
    process: org.owasp.dependencycheck.App
  pushdown: {}
- node:
    name: node_4
    dns_pattern: ossindex.sonatype.org
    dst_port: 443
  pushdown:
    dns_pattern: .*:ossindex.sonatype.org:.*
- node:
    name: node_5
    dns_pattern: search.maven.org
    dst_port: 443
  pushdown:
    dns_pattern: .*:search.maven.org:.*
- node:
    name: node_6
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /opt/araali/bin/guarantor.current
    parent_process: araalictl
    process: guarantor
  pushdown: {}
- node:
    name: node_7
    rename: fog
    dns_pattern: .*.fog.*.aws.araalinetworks.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:.*.fog.*.aws.araalinetworks.com:.*
- node:
    name: node_8
    zone: .*
    app: kube-system
    pod: .*araali-fw
    container: .*araali-fw
    binary_name: /opt/araali/bin/grype
    parent_process: guarantor-helpe
    process: grype
  pushdown: {}
- node:
    name: node_9
    dns_pattern: toolbox-data.anchore.io
    dst_port: 443
  pushdown:
    dns_pattern: .*:toolbox-data.anchore.io:.*
authorizations:
- name: node_1
  in:
  - araali_cni
  out:
  - node_7
- name: node_10
  out:
  - node_11
  - node_12
  - node_21
  - node_4
  - node_5
- name: node_13
  out:
  - node_14
  - node_15
  - node_24
- name: node_16
  out:
  - node_17
  - node_23
- name: node_22
  out:
  - node_26
  - node_27
  - node_9
- name: node_25
  out:
  - node_9
- name: node_3
  out:
  - node_21
  - node_4
  - node_5
- name: node_6
  out:
  - node_7
- name: node_8
  out:
  - node_18
  - node_19
  - node_20
  - node_9
