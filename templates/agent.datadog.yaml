identities:
- node:
    name: agent
    dns_pattern: .*-app.agent.datadoghq.com
    dst_port: 443
  pushdown:
    dns_pattern: .*:.*-app.agent.datadoghq.com:.*
- node:
    name: agent_intake_logs
    dns_pattern: agent-http-intake.logs.datadoghq.com
    dst_port: 443
  pushdown: {}
- node:
    name: any
    zone: .*
    app: .*
    pod: .*
    container: .*
    binary_name: .*
    parent_process: .*
    process: .*
  pushdown: {}
- node:
    name: api
    dns_pattern: api.datadoghq.com
    dst_port: 443
  pushdown: {}
- node:
    name: apt
    dns_pattern: apt.datadoghq.com
    dst_port: 443
  pushdown: {}
- node:
    name: apt_get_https
    zone: .*
    app: .*
    binary_name: /usr/lib/apt/methods/http
    parent_process: apt-get
    process: https
  pushdown: {}
- node:
    name: s6_supervise
    zone: .*
    app: .*
    pod: .*
    container: datadog
    binary_name: /opt/datadog-agent/bin/agent/agent
    parent_process: s6-supervise
    process: agent
  pushdown: {}
- node:
    name: s6_supervise_trace_agent
    zone: .*
    app: .*
    pod: .*
    container: datadog
    binary_name: /opt/datadog-agent/embedded/bin/trace-agent
    parent_process: s6-supervise
    process: trace-agent
  pushdown: {}
- node:
    name: systemd_agent
    zone: .*
    app: .*
    binary_name: /opt/datadog-agent/bin/agent/agent
    parent_process: systemd
    process: agent
  pushdown: {}
- node:
    name: trace_agent
    dns_pattern: trace.agent.datadoghq.com
    dst_port: 443
  pushdown: {}
authorizations:
- name: any
  out:
  - api
- name: apt
  in:
  - apt_get_https
- name: s6_supervise
  out:
  - agent
  - agent_intake_logs
  - api
- name: systemd_agent
  out:
  - agent_intake_logs
  - api
- name: trace_agent
  in:
  - s6_supervise_trace_agent
